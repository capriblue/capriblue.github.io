<!doctype html>
<html>

<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

	<title>統計力学問題発表</title>

	<link rel="stylesheet" href="dist/reset.css">
	<link rel="stylesheet" href="dist/reveal.css">
	<link rel="stylesheet" href="dist/custtom.css" id="theme">

	<script>
		MathJax = {
			loader: { load: ['[tex]/physics', '[tex]/ams'] },
			tex: {
				inlineMath: [['$', '$'], ['\\(', '\\)']],
				packages: { '[+]': ['physics', 'ams'] }
			},
			chtml: {
				matchFontHeight: false
			}
		};
	</script>
	<script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js">
	</script>
</head>

<body>
	<div class="reveal">
		<div class="slides">
			<section>
				<h2>統計力学　演習A 問題2-4 答案</h2>
				<p class="author">藤井淳太朗</p>
				<p class="date"> 発表日: 2021/4/16</p>
			</section>
			<section>
				<section>
					<h2>問題A</h2>

					<div class="itembox">

						<h3>ガウス分布の性質について</h3>

						確率密度関数を
						$$
						\rho(x) = \frac{1}{\sqrt{2\pi \sigma^2}}\exp\left(-\frac{(x-\mu)^2}{2\sigma^2}\right)
						$$
						とすると、$\expval{x} = \mu, \expval{x^2} = \mu^2 + \sigma^2$となる。

					</div>
					期待値は
					$$
					\expval{\hat{x}} = \frac{1}{N}\sum_{k=1}^{N} \expval{ \hat{x}^{(k)}} = \frac{1}{N}\sum_{k=1}^{N}x_0
					= x_0
					$$
					となる。
				</section>
				<section>
					変数の2乗の期待値は
					$$
					\begin{align}
					\expval{\hat{x^2}}
					&= \expval{ \left(\frac{1}{N} \sum_{k=1}^{N} \hat{x}^{(k)}\right)^2} \\\\
					&= \frac{1}{N^2} \sum_{k=1}^{N} \sum_{l=1}^{N} \expval{\hat{x}^{(k)}\hat{x}^{(l)}}
					\end{align}
					$$
					ここで、$k=l$のとき、
					$$
					\expval{\hat{x}^{(k)}\hat{x}^{(l)}} = \expval{ \hat{x}^{(k)2}} = \sigma^{2}+x_0^2
					$$
					$k\neq l$のとき、各変数が独立であることを用いて、
					$$
					\expval{ \hat{x}^{(k)}\hat{x}^{(l)}} = \expval{ \hat{x}^{(k)}} \expval{ \hat{x}^{(l)}} = x_0^2
					$$
					と計算される。

				</section>
				<section>
					また$k=l$は$N$個、$k\neq l$は$N^2-N$個となるから、
					$$
					\begin{align}
					\expval{\hat{x}^2}
					&= \frac{1}{N^2} (N(\sigma^2+x_0^2)+ (N^2-N)x_0^2) \\\\
					&= \frac{1}{N} (\sigma^2 + x_0^2 +Nx_0^2 -x_0^2) \\\\
					&= x_0^2 + \frac{\sigma^2}{N}
					\end{align}
					$$
					したがって、分散$\dfrac{\sigma^2}{N}$, 期待値$x_0$となる。

				</section>
			</section>
			<section>
				<section>
					<h2>問題B</h2>

					初めに以下の命題を証明する。
					<div class="itembox">

						分布$p(x,y)$があるとき、$u = x+ y $の分布$\varphi(u)$は
						$$
						\varphi(u) = \int_{-\infty}^{\infty} p(u - v, v)dv
						$$
						で与えられ、特に$x,y$が独立ならば、xの分布を$q(x)$、$y$の分布を$r(y)$として、
						$$
						\varphi(u ) = (q \ast r)(u) = \int_{-\infty}^{\infty} q(u-v)r(v)dv
						$$
						で与えられる。

					</div>
				</section>
				<section>
					(証明)
					$u=x+y,v=y$と$(x,y) \rightarrow (u,v)$の変数変換をすると$\varphi(u)$は$v$の周辺分布になる。
					$$
					\varphi(u) = \int_{-\infty}^{\infty} \tilde{p}(u,v)dv
					$$
					一方で、変数変換のヤコビアンは
					$$
					\left| \frac{\partial(x,y)}{\partial(u,v)} \right| = 1
					$$
					となるから、$\tilde{p}(u,v) = p(x,y) = p(u-v,v)$とでき、

					$$
					\varphi(u) = \int_{-\infty}^{\infty} p(u-v, v)dv
					$$

					特に、独立な場合、$p(x,y) = q(x)r(y)$とできるから、
					$$
					\varphi(u) = \int_{-\infty}^{\infty} q(u-v)r(v)dv = (q \ast r) (u)
					$$
					(証明終了)

				</section>
				<section>
					$\hat{y} = x^{(1)} + x^{(2)}$について、確率密度関数$\rho'(y)$は、$x^{(i)}$の確率密度関数を$\rho^{(i)}(x)$として、
					$$
					\begin{align}
					\rho'(y)
					&= (\rho^{(1)} \ast \rho^{(2)})(x) \\\\
					&= \int_{-\infty}^{\infty} \rho^{(1)}(x-t)\rho^{(2)}(t)dt\\\\
					\end{align}
					$$

					ここで$\rho^{(i)}(x)$は期待値$x_0$,分散$\sigma^2$のガウス分布であるから、
					$$
					\begin{align}
					\rho'(y)
					&= \int_{-\infty}^{\infty} \frac{1}{2\pi \sigma^2} \exp\left[-\frac{1}{2\sigma^2} \{
					(x-t-x_0)^2+(t-x_0)^2\}\right]dt\\
					&=\frac{1}{2\pi \sigma^2} \int_{-\infty}^{\infty} \exp\left[-\frac{1}{2\sigma^2} \left[
					2\left(t-\frac{x}{2}\right)^2 + \frac{1}{2}(x-2x_0)^2\right]\right]dt\\
					&=\frac{1}{2\pi \sigma^2}
					\mathrm{e}^{-\frac{1}{4\sigma^2}(x-2x_0)^2}\int_{-\infty}^{\infty}\mathrm{e}^{-\frac{\left(t-\frac{x}{2}\right)^2}{\sigma^2}}dt\\
					&= \frac{1}{2\sqrt{\pi \sigma^2}} \mathrm{e}^{-\frac{\left(x^2-x_0\right)^2}{4\sigma^2}}
					\end{align}
					$$

				</section>
				<section>
					確率密度関数$\rho_2(x)$と$\rho'(y)$は
					$$
					\rho_2(x)dx = \rho'(y)dy
					$$
					であり、$y=2x$で結ばれるから
					$$
					\rho_2(x) = \rho'(y)\frac{dy}{dx} = 2\rho'(2x)
					$$
					となる。したがって
					$$
					\rho_2(x) = \frac{1}{\sqrt{\pi \sigma^2}}\exp\left[ -\frac{(x-x_0)^2}{\sigma^2} \right]
					$$


				</section>
			</section>
			<section>
				<section>
					<h2>
						問題C
					</h2>

					問題 Bにおける命題は$N$変数に拡張することができる。すなわち独立な確率変数の和で構成された確率変数$\hat{y}=\sum_{i=1}^{N}x^{(i)}$の確率密度関数$\rho(y)$は
					$$
					\rho(y) = (\rho^{(1)} \ast \rho^{(2)} \ast \cdots \rho^{(N)})(y)
					$$
					で与えられる。
					畳み込みを具体的に書き下すと、
					$$
					\rho(y) = \int dx^{(1)}\cdots dx^{(N)}\rho^{(1)}(x^{(1)}) \cdots
					\rho^{(N-1)}(x^{(N-1)})\rho^{(N)}(y-\sum_{i=1}^{N-1}x^{(i)})
					$$
					またデルタ関数を用いると、
					$$
					\rho^{(N)}(y-\sum_{i=1}^{N-1}x^{(i)}) =
					\int_{-\infty}^{\infty}dx^{(N)}\rho^{(N)}(x^{(N)})\delta(y-\sum_{i=1}^{N}x^{(i)})
					$$
					となる。

				</section>
				<section>
					さらに$\rho_N(x) = N\rho(y)$であるから、
					$$
					\begin{align}
					f(x,x^{(1)},x^{(2)}, \cdots ,x^{(N)})
					&= N\prod_{i=1}^{N}\rho^{(i)}(x^{(i)})\delta(x-\sum_{i=1}^{N}x^{(i)}) \\\\
					&= \frac{N}{(2\pi \sigma^2)^{\frac{N}{2}}}\exp\left[
					-\frac{1}{2\sigma^2}\sum_{i=1}^{N}(x^{i}-x_0)^2\right] \\\\
					& \quad \times \delta(x-\sum_{i=1}^N x^{(i)})
					\end{align}
					$$

				</section>
			</section>
			<section>
				<section>
					<h2>問題D</h2>
					<div class="itembox">

						畳み込みのフーリエ変換<br>

						フーリエ変換を
						$$
						\mathcal{F}[f(x)] = \int_{-\infty}^{\infty}dx f(x)\mathrm{e}^{ikx}
						$$
						と定義する。
						$\tilde{f}(k),\tilde{g}(k)$を$f(x)$,$g(x)$のフーリエ変換として、
						$$
						\mathcal{F}[(f\ast g)(x)] = \tilde{f}(k)\tilde{g}(k)
						$$
					</div>

				</section>
				<section>
					(証明)
					$$
					\begin{align}
					\mathcal{F}[(f\ast g)(x)]
					&= \int_{-\infty}^{\infty}\left[ \int_{-\infty}^{\infty}f(x')g(x-x')dx'
					\right]\mathrm{e}^{ikx}dx\\\\
					&=
					\int_{-\infty}^{\infty}f(x')\left[\int_{-\infty}^{\infty}g(x-x_0)\mathrm{e}^{ik(x-x')}dx\right]\mathrm{e}^{ikx'}dx'\\\\
					&= \int_{-\infty}^{\infty}g(y)\mathrm{e}^{iky}dy \int_{-\infty}^{\infty}f(x')\mathrm{e}^{ikx'}dx'
					\quad (y = x-x')\\\\
					&= \tilde{f}(k)\tilde{g}(k)
					\end{align}
					$$

					(証明終了)

				</section>
				<section>
					したがって、
					$$
					\rho(y) = (\rho^{(1)} \ast \rho^{(2)} \ast \cdots \rho^{(N)})(y)
					$$
					をフーリエ変換すると、ガウス分布の特性関数を$\tilde{\rho}_G(k)$として、
					$$
					\begin{align}
					\mathcal{F}[\rho'(y)]
					&= \tilde{\rho}^{(1)}(k^{(1)})\cdots \tilde{\rho}^{(N)}(k^{(N)}) \\\\
					&= (\tilde{\rho}_G(k))^N
					\end{align}
					$$
					とできる。

					ガウス分布の特性関数を求めると
					$
					\tilde{\rho}_{G} (k)=
					$

					$$
					=\int_{-\infty}^{\infty}dx\frac{1}{\sqrt{2\pi
					\rho^2}}\mathrm{e}^{-\frac{(x-x_0)}{2\sigma^2}}\mathrm{e}^{ikx}= \frac{1}{\sqrt{2\pi
					\sigma^2}}\int_{-\infty}^{\infty}\exp\left[-\frac{1}{2\sigma^2}(x-(x_0+ik\sigma^2))^2 + ikx_0
					-\frac{\sigma^2k^2}{2}\right]
					$$
					$$
					= \exp\left[x_0 ik -\frac{\sigma^2k^2}{2}\right]
					$$

					となる。

				</section>
				<section>
					したがって、
					$$
					\begin{align}
					\rho'(y)
					&= \mathcal{F}^{-1} \left[ \exp\left[ N\left(x_0ik-\frac{\sigma^2k^2}{2}\right)\right]\right]\\\\
					&= \frac{1}{2\pi }\int_{-\infty}^{\infty}dk
					\exp\left[-\frac{N\sigma^2}{2}\left(t-\frac{Nx_0-x}{N\sigma^2}i\right)^2 -
					\frac{(x_0N-x)^2}{2N\sigma^2}\right] \\\\
					&= \frac{1}{2\pi} \sqrt{\frac{2\pi}{N\sigma^2 }} \exp\left[ -\frac{(x_0N-x)^2}{2N\sigma^2}\right] =
					\frac{1}{\sqrt{2\pi N\sigma^2}} exp\left[ -\frac{(x_0N-x)^2}{2N\sigma^2}\right]
					\end{align}
					$$

					また$\rho_N(x)=N\rho'(y)=N\rho(Nx)$より、
					$$
					\rho_N(x) = \frac{1}{\sqrt{2\pi \left(\frac{\sigma^2}{N}\right)}} \exp \left[ -
					\frac{(x-x_0)^2}{2\left(\frac{\sigma^2}{N}\right)}\right]
					$$
					となる。これは期待値$x_0$、分散$\dfrac{\sigma^2}{N}$のガウス分布となっている。確かに問題 aの結果と一致している。
				</section>
			</section>
		</div>
	</div>

	<script src="dist/reveal.js"></script>
	<script>
		Reveal.initialize({
		});
	</script>
</body>

</html>